"use strict";(self.webpackChunkliveVideoAndProject=self.webpackChunkliveVideoAndProject||[]).push([[167],{63993:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AnchorBase=void 0;const r=s(n(67294)),l=n(46458),d=c(n(94184)),u=n(49330),a=n(34413),_=n(24509);t.AnchorBase=e=>{const{anchor:t,children:n,className:o}=e,i=l.useDispatch(),[s,c]=r.useState(),[,f]=r.useState(null),O=l.useSelector((e=>a.isSidenoteSelected(e,s,t))),E=r.useCallback((e=>{f(e);const n=_.getDoc(e);n&&(c(n),i(u.connectAnchorBase(n,t,e)))}),[]),I=d.default({selected:O,[null!=o?o:""]:Boolean(o)});return r.default.createElement("div",{className:I,ref:E},n)},t.AnchorBase.defaultProps={className:void 0},t.default=t.AnchorBase},69415:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InlineAnchor=void 0;const r=s(n(67294)),l=n(46458),d=c(n(94184)),u=n(49330),a=n(34413),_=n(24509);t.InlineAnchor=e=>{const{sidenote:t,children:n,className:o}=e,i=l.useDispatch(),[s,c]=r.useState(),[f,O]=r.useState(null);r.useEffect((()=>null==f||null==s?()=>{}:()=>i(u.disconnectAnchor(s,f))),[s,f]);const E=l.useSelector((e=>a.isSidenoteSelected(e,s,t))),I=r.useCallback((e=>{e.stopPropagation(),i(u.selectAnchor(s,f))}),[s,f]),S=r.useCallback((e=>{O(e);const n=_.getDoc(e);n&&(c(n),i(u.connectAnchor(n,t,e)))}),[]),p=d.default("anchor",{selected:E,[null!=o?o:""]:Boolean(o)});return r.default.createElement("span",{className:p,onClick:I,ref:S},n)},t.InlineAnchor.defaultProps={className:void 0},t.default=t.InlineAnchor},24851:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Sidenote=void 0;const r=s(n(67294)),l=n(46458),d=c(n(94184)),u=n(49330),a=n(34413),_=n(24509);t.Sidenote=e=>{const{base:t,sidenote:n,children:o}=e,i=l.useDispatch(),[s,c]=r.useState(),f=l.useSelector((e=>a.isSidenoteSelected(e,s,n))),O=l.useSelector((e=>a.sidenoteTop(e,s,n))),E=r.useCallback((e=>{e.stopPropagation(),f||i(u.selectSidenote(s,n))}),[s,f]),I=r.useCallback((e=>{const o=_.getDoc(e);o&&(c(o),i(u.connectSidenote(o,n,t)))}),[]);return r.default.createElement("div",{id:n,className:d.default("sidenote",{selected:f}),onClick:E,ref:I,style:{top:O}},o)},t.Sidenote.defaultProps={base:void 0},t.default=t.Sidenote},88073:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AnchorBase=t.InlineAnchor=t.Sidenote=void 0;var i=n(24851);Object.defineProperty(t,"Sidenote",{enumerable:!0,get:function(){return o(i).default}});var s=n(69415);Object.defineProperty(t,"InlineAnchor",{enumerable:!0,get:function(){return o(s).default}});var c=n(63993);Object.defineProperty(t,"AnchorBase",{enumerable:!0,get:function(){return o(c).default}})},24509:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDoc=void 0,t.getDoc=e=>{var t;const n=null===(t=null==e?void 0:e.closest("article"))||void 0===t?void 0:t.id;return e&&!n&&console.warn("Parent doc for comment not found."),n||"global"}},73257:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.opts=t.store=t.setup=t.ref=void 0;const o=n(78410);t.ref={store(){if(void 0===t.ref._store)throw new Error("Must init store.");return t.ref._store},opts(){if(void 0===t.ref._opts)throw new Error("Must init opts.");return t.ref._opts}};const i={};let s;t.setup=function(e,n){t.ref._store=e,t.ref._opts=n,e.subscribe((()=>function(e){const t=s;s=e.getState().sidenotes,t!==s&&Object.keys(i).forEach((e=>{const{listener:t}=i[e];t()}))}(e)))},t.store={getState:()=>t.ref.store().getState(),dispatch:e=>t.ref.store().dispatch(e),subscribe:e=>function(e){const t=o.v4();return i[t]={listener:e},()=>delete i[t]}(e)},t.opts={get padding(){var e;return null!==(e=t.ref.opts().padding)&&void 0!==e?e:10}}},97073:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.store=t.setup=void 0,i(n(63964),t);var s=n(73257);Object.defineProperty(t,"setup",{enumerable:!0,get:function(){return s.setup}}),Object.defineProperty(t,"store",{enumerable:!0,get:function(){return s.store}}),i(n(88073),t)},63964:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.selectors=t.actions=t.reducer=void 0;const l=s(n(49330));t.actions=l;const d=s(n(34413));t.selectors=d;const u=r(n(63462));t.reducer=u.default,c(n(78228),t)},63462:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(23828),s=o(n(89141)),c=i.combineReducers({ui:s.default});t.default=c},78228:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},49330:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.repositionSidenotes=t.deselectSidenote=t.disableNextDeselectSidenote=t.resetAllSidenotes=t.disconnectAnchor=t.disconnectSidenote=t.selectAnchor=t.selectSidenote=t.updateSidenote=t.connectAnchorBase=t.connectAnchor=t.connectSidenote=void 0;const o=n(78410),i=n(64962),s=n(34413);t.connectSidenote=function(e,t,n){return o=>{null!=e&&null!=t&&o({type:i.UI_CONNECT_SIDENOTE,payload:{docId:e,sidenoteId:t,baseId:n}})}},t.connectAnchor=function(e,t,n){return s=>{if(null==e||null==t||null==n)return;const c="string"==typeof n?n:o.v4();"string"!=typeof n&&(n.anchorId=c),s({type:i.UI_CONNECT_ANCHOR,payload:{docId:e,sidenoteId:t,anchorId:c,element:"string"==typeof n?void 0:n}})}},t.connectAnchorBase=function(e,t,n){return o=>{null!=e&&null!=t&&null!=n&&(n.anchorId=t,o({type:i.UI_CONNECT_ANCHOR_BASE,payload:{docId:e,anchorId:t,element:n}}))}},t.updateSidenote=function(e,t){return{type:i.UI_SELECT_SIDENOTE,payload:{docId:e,sidenoteId:t}}},t.selectSidenote=function(e,t){return n=>{n({type:i.UI_SELECT_SIDENOTE,payload:{docId:e,sidenoteId:t}})}},t.selectAnchor=function(e,t){return n=>{if(null==e||null==t)return;const o="string"==typeof t?t:t.anchorId;o&&n({type:i.UI_SELECT_ANCHOR,payload:{docId:e,anchorId:o}})}},t.disconnectSidenote=function(e,t){return n=>{null!=e&&null!=t&&n({type:i.UI_DISCONNECT_SIDENOTE,payload:{docId:e,sidenoteId:t}})}},t.disconnectAnchor=function(e,t){return n=>{if(null==e||null==t)return;const o="string"==typeof t?t:t.anchorId;o&&n({type:i.UI_DISCONNECT_ANCHOR,payload:{docId:e,anchorId:o}})}},t.resetAllSidenotes=function(){return e=>{e({type:i.UI_RESET_ALL_SIDENOTES,payload:{}})}};const c={active:!1};t.disableNextDeselectSidenote=function(){c.active=!0},t.deselectSidenote=function(e){return(t,n)=>{c.active?c.active=!1:s.selectedSidenote(n(),e)&&t({type:i.UI_DESELECT_SIDENOTE,payload:{docId:e}})}},t.repositionSidenotes=function(e){return{type:i.UI_REPOSITION_SIDENOTES,payload:{docId:e}}}},97199:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(64962);t.default=(e,t)=>{var n,i,s,c,r,l,d,u,a,_,f;if(null==e&&t.type!==o.UI_RESET_ALL_SIDENOTES){const{docId:n}=t.payload;e={id:n,selectedSidenote:null,selectedAnchor:null,sidenotes:{},anchors:{}}}switch(t.type){case o.UI_REPOSITION_SIDENOTES:return e;case o.UI_CONNECT_SIDENOTE:{const{sidenoteId:o,baseId:s}=t.payload,c=s?[s]:[],r=e.sidenotes[o];return Object.assign(Object.assign({},e),{sidenotes:Object.assign(Object.assign({},e.sidenotes),{[o]:Object.assign(Object.assign({},r),{id:o,baseAnchors:[...c,...null!==(n=null==r?void 0:r.baseAnchors)&&void 0!==n?n:[]],inlineAnchors:[...null!==(i=null==r?void 0:r.inlineAnchors)&&void 0!==i?i:[]]})})})}case o.UI_DISCONNECT_SIDENOTE:{const{sidenoteId:n}=t.payload,o=e.sidenotes[n];if(!o)return e;const i=Object.assign({},e.sidenotes);return delete i[o.id],Object.assign(Object.assign({},e),{sidenotes:i})}case o.UI_CONNECT_ANCHOR:{const{sidenoteId:n,anchorId:o,element:i}=t.payload,c=e.sidenotes[n];return Object.assign(Object.assign({},e),{sidenotes:Object.assign(Object.assign({},e.sidenotes),{[n]:Object.assign(Object.assign({},c),{inlineAnchors:[o,...null!==(s=null==c?void 0:c.inlineAnchors)&&void 0!==s?s:[]]})}),anchors:Object.assign(Object.assign({},e.anchors),{[o]:{id:o,sidenote:n,element:i}})})}case o.UI_CONNECT_ANCHOR_BASE:{const{anchorId:n,element:i}=t.payload;return Object.assign(Object.assign({},e),{anchors:Object.assign(Object.assign({},e.anchors),{[n]:{id:n,sidenote:o.ANCHOR_BASE,element:i}})})}case o.UI_DISCONNECT_ANCHOR:{const{anchorId:n}=t.payload,o=e.anchors[n];if(!o)return e;const i=Object.assign({},e.anchors);delete i[o.id];const s=e.sidenotes[o.sidenote];return Object.assign(Object.assign({},e),{sidenotes:Object.assign(Object.assign({},e.sidenotes),{[o.sidenote]:Object.assign(Object.assign({},s),{inlineAnchors:[...null!==(c=null==s?void 0:s.inlineAnchors)&&void 0!==c?c:[]].filter((e=>e!==n))})}),anchors:i})}case o.UI_SELECT_SIDENOTE:{const{sidenoteId:n}=t.payload,o=e.sidenotes[n];return Object.assign(Object.assign({},e),{selectedSidenote:n,selectedAnchor:null!==(u=null!==(l=null===(r=null==o?void 0:o.inlineAnchors)||void 0===r?void 0:r[0])&&void 0!==l?l:null===(d=null==o?void 0:o.baseAnchors)||void 0===d?void 0:d[0])&&void 0!==u?u:null,sidenotes:Object.assign(Object.assign({},e.sidenotes),{[n]:Object.assign(Object.assign({},o),{id:n,baseAnchors:[...null!==(a=null==o?void 0:o.baseAnchors)&&void 0!==a?a:[]],inlineAnchors:[...null!==(_=null==o?void 0:o.inlineAnchors)&&void 0!==_?_:[]]})})})}case o.UI_SELECT_ANCHOR:{const{anchorId:n}=t.payload,o=e.anchors[n];if(!o)return e;const i=e.sidenotes[o.sidenote],s=[n,...[...null!==(f=null==i?void 0:i.inlineAnchors)&&void 0!==f?f:[]].filter((e=>e!==n))];return Object.assign(Object.assign({},e),{sidenotes:Object.assign(Object.assign({},e.sidenotes),{[o.sidenote]:Object.assign(Object.assign({},i),{inlineAnchors:s})}),selectedAnchor:n,selectedSidenote:o.sidenote})}case o.UI_DESELECT_SIDENOTE:return Object.assign(Object.assign({},e),{selectedAnchor:null,selectedSidenote:null});default:return e}}},89141:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;const i=n(73257),s=o(n(97199)),c=n(64962);function r(e){var t,n;return null!==(n=null===(t=document.getElementById(e))||void 0===t?void 0:t.offsetHeight)&&void 0!==n?n:0}function l(e){var t;let n=e,o=0,i=0;do{o+=(null==n?void 0:n.offsetTop)||0,i+=(null==n?void 0:n.offsetLeft)||0,n=null!==(t=null==n?void 0:n.offsetParent)&&void 0!==t?t:null}while(n&&"ARTICLE"!==n.tagName);return{top:o,left:i}}t.initialState={docs:{}},t.default=(e=t.initialState,n)=>{switch(n.type){case c.UI_SELECT_SIDENOTE:case c.UI_SELECT_ANCHOR:case c.UI_CONNECT_SIDENOTE:case c.UI_CONNECT_ANCHOR:case c.UI_CONNECT_ANCHOR_BASE:case c.UI_DISCONNECT_ANCHOR:case c.UI_DISCONNECT_SIDENOTE:case c.UI_DESELECT_SIDENOTE:case c.UI_REPOSITION_SIDENOTES:{const{docId:t}=n.payload,o=function(e,t){if(t===c.UI_DESELECT_SIDENOTE)return e;let n;const o=Object.entries(e.sidenotes).map((([t,o])=>{const i=function(e,t){var n,o,i,s;const c=[...null!==(n=t.inlineAnchors)&&void 0!==n?n:[],...null!==(o=t.baseAnchors)&&void 0!==o?o:[]];for(let t=0;t<c.length;t+=1){const n=e.anchors[c[t]],o=null!==(i=null==n?void 0:n.element)&&void 0!==i?i:document.getElementById(null!==(s=null==n?void 0:n.id)&&void 0!==s?s:"");if(o)return o}return null}(e,o),s=[t,Object.assign(Object.assign({},l(i)),{height:r(t)})];return t===e.selectedSidenote&&(n=s),s})).sort(((e,t)=>e[1].top===t[1].top?e[1].left-t[1].left:e[1].top-t[1].top)),s=n?o.indexOf(n):0,d=o.slice(0,s+1).reduceRight(((e,[t,n])=>{var o,s;const{top:c}=null!==(s=null===(o=e[e.length-1])||void 0===o?void 0:o[1])&&void 0!==s?s:{},r=[t,{top:Math.min(c-n.height-i.opts.padding,n.top)||n.top,height:n.height}];return[...e,r]}),[]),u=o.slice(s).reduce(((e,[t,n])=>{var o,s;const{top:c,height:r}=null!==(s=null===(o=e[e.length-1])||void 0===o?void 0:o[1])&&void 0!==s?s:{},l=[t,{top:Math.max(c+r+i.opts.padding,n.top)||n.top,height:n.height}];return[...e,l]}),[]),a=Object.fromEntries([...d,...u]);let _=!1;const f=Object.fromEntries(Object.entries(e.sidenotes).map((([e,t])=>{const{top:n}=a[e];return t.top!==n?(_=!0,[e,Object.assign(Object.assign({},t),{top:n})]):[e,t]})));return _?Object.assign(Object.assign({},e),{sidenotes:f}):e}(s.default(e.docs[t],n),n.type);return Object.assign(Object.assign({},e),{docs:Object.assign(Object.assign({},e.docs),{[t]:o})})}case c.UI_RESET_ALL_SIDENOTES:return Object.assign(Object.assign({},e),{docs:{}});default:return e}}},34413:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isAnchorSelected=t.sidenoteTop=t.isSidenoteSelected=t.selectedSidenote=void 0,t.selectedSidenote=function(e,t){var n;return null==t?null:null===(n=e.sidenotes.ui.docs[t])||void 0===n?void 0:n.selectedSidenote},t.isSidenoteSelected=function(e,t,n){var o;return null!=t&&null!=n&&(null===(o=e.sidenotes.ui.docs[t])||void 0===o?void 0:o.selectedSidenote)===n},t.sidenoteTop=function(e,t,n){var o,i,s;return null==t||null==n?0:null!==(s=null===(i=null===(o=e.sidenotes.ui.docs[t])||void 0===o?void 0:o.sidenotes[n])||void 0===i?void 0:i.top)&&void 0!==s?s:0},t.isAnchorSelected=function(e,t,n){var o;return null!=t&&null!=n&&(null===(o=e.sidenotes.ui.docs[t])||void 0===o?void 0:o.selectedAnchor)===n}},64962:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UI_RESET_ALL_SIDENOTES=t.UI_REPOSITION_SIDENOTES=t.UI_UPDATE_COMMENT=t.UI_SELECT_ANCHOR=t.UI_DESELECT_SIDENOTE=t.UI_SELECT_SIDENOTE=t.UI_DISCONNECT_ANCHOR=t.UI_CONNECT_ANCHOR_BASE=t.UI_CONNECT_ANCHOR=t.UI_DISCONNECT_SIDENOTE=t.UI_CONNECT_SIDENOTE=t.ANCHOR_BASE=void 0,t.ANCHOR_BASE="ANCHOR_BASE",t.UI_CONNECT_SIDENOTE="UI_CONNECT_SIDENOTE",t.UI_DISCONNECT_SIDENOTE="UI_DISCONNECT_SIDENOTE",t.UI_CONNECT_ANCHOR="UI_CONNECT_ANCHOR",t.UI_CONNECT_ANCHOR_BASE="UI_CONNECT_ANCHOR_BASE",t.UI_DISCONNECT_ANCHOR="UI_DISCONNECT_ANCHOR",t.UI_SELECT_SIDENOTE="UI_SELECT_SIDENOTE",t.UI_DESELECT_SIDENOTE="UI_DESELECT_SIDENOTE",t.UI_SELECT_ANCHOR="UI_SELECT_ANCHOR",t.UI_UPDATE_COMMENT="UI_UPDATE_COMMENT",t.UI_REPOSITION_SIDENOTES="UI_REPOSITION_SIDENOTES",t.UI_RESET_ALL_SIDENOTES="UI_RESET_ALL_SIDENOTES"}}]);